var Qr=Object.defineProperty;var kr=(Z,se,Te)=>se in Z?Qr(Z,se,{enumerable:!0,configurable:!0,writable:!0,value:Te}):Z[se]=Te;var F=(Z,se,Te)=>(kr(Z,typeof se!="symbol"?se+"":se,Te),Te);(function(){"use strict";var Z=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},se={exports:{}};(function(i,r){var a=200,d="__lodash_hash_undefined__",u=1,h=2,f=9007199254740991,c="[object Arguments]",g="[object Array]",y="[object AsyncFunction]",w="[object Boolean]",z="[object Date]",R="[object Error]",M="[object Function]",te="[object GeneratorFunction]",ne="[object Map]",Ee="[object Number]",ht="[object Null]",k="[object Object]",Qe="[object Promise]",pt="[object Proxy]",xe="[object RegExp]",Ie="[object Set]",ke="[object String]",et="[object Symbol]",gt="[object Undefined]",Me="[object WeakMap]",yt="[object ArrayBuffer]",Ue="[object DataView]",Yt="[object Float32Array]",Jt="[object Float64Array]",Xt="[object Int8Array]",Zt="[object Int16Array]",Qt="[object Int32Array]",kt="[object Uint8Array]",en="[object Uint8ClampedArray]",tn="[object Uint16Array]",nn="[object Uint32Array]",rn=/[\\^$.*+?()[\]{}|]/g,sn=/^\[object .+?Constructor\]$/,an=/^(?:0|[1-9]\d*)$/,O={};O[Yt]=O[Jt]=O[Xt]=O[Zt]=O[Qt]=O[kt]=O[en]=O[tn]=O[nn]=!0,O[c]=O[g]=O[yt]=O[w]=O[Ue]=O[z]=O[R]=O[M]=O[ne]=O[Ee]=O[k]=O[xe]=O[Ie]=O[ke]=O[Me]=!1;var _t=typeof Z=="object"&&Z&&Z.Object===Object&&Z,on=typeof self=="object"&&self&&self.Object===Object&&self,T=_t||on||Function("return this")(),tt=r&&!r.nodeType&&r,vt=tt&&!0&&i&&!i.nodeType&&i,ae=vt&&vt.exports===tt,He=ae&&_t.process,nt=function(){try{return He&&He.binding&&He.binding("util")}catch{}}(),bt=nt&&nt.isTypedArray;function wt(t,s){for(var l=-1,_=t==null?0:t.length,C=0,A=[];++l<_;){var I=t[l];s(I,l,t)&&(A[C++]=I)}return A}function At(t,s){for(var l=-1,_=s.length,C=t.length;++l<_;)t[C+l]=s[l];return t}function St(t,s){for(var l=-1,_=t==null?0:t.length;++l<_;)if(s(t[l],l,t))return!0;return!1}function fn(t,s){for(var l=-1,_=Array(t);++l<t;)_[l]=s(l);return _}function un(t){return function(s){return t(s)}}function cn(t,s){return t.has(s)}function ln(t,s){return t==null?void 0:t[s]}function dn(t){var s=-1,l=Array(t.size);return t.forEach(function(_,C){l[++s]=[C,_]}),l}function hn(t,s){return function(l){return t(s(l))}}function rt(t){var s=-1,l=Array(t.size);return t.forEach(function(_){l[++s]=_}),l}var pn=Array.prototype,gn=Function.prototype,Fe=Object.prototype,it=T["__core-js_shared__"],mt=gn.toString,V=Fe.hasOwnProperty,Ge=function(){var t=/[^.]+$/.exec(it&&it.keys&&it.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),st=Fe.toString,Tt=RegExp("^"+mt.call(V).replace(rn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ee=ae?T.Buffer:void 0,oe=T.Symbol,Mt=T.Uint8Array,at=Fe.propertyIsEnumerable,Ct=pn.splice,pe=oe?oe.toStringTag:void 0,Ot=Object.getOwnPropertySymbols,yn=ee?ee.isBuffer:void 0,ot=hn(Object.keys,Object),ge=Ce(T,"DataView"),ye=Ce(T,"Map"),Pe=Ce(T,"Promise"),Le=Ce(T,"Set"),_e=Ce(T,"WeakMap"),De=Ce(Object,"create"),_n=ce(ge),vn=ce(ye),bn=ce(Pe),wn=ce(Le),We=ce(_e),qe=oe?oe.prototype:void 0,ze=qe?qe.valueOf:void 0;function Y(t){var s=-1,l=t==null?0:t.length;for(this.clear();++s<l;){var _=t[s];this.set(_[0],_[1])}}function An(){this.__data__=De?De(null):{},this.size=0}function Sn(t){var s=this.has(t)&&delete this.__data__[t];return this.size-=s?1:0,s}function mn(t){var s=this.__data__;if(De){var l=s[t];return l===d?void 0:l}return V.call(s,t)?s[t]:void 0}function Tn(t){var s=this.__data__;return De?s[t]!==void 0:V.call(s,t)}function Mn(t,s){var l=this.__data__;return this.size+=this.has(t)?0:1,l[t]=De&&s===void 0?d:s,this}Y.prototype.clear=An,Y.prototype.delete=Sn,Y.prototype.get=mn,Y.prototype.has=Tn,Y.prototype.set=Mn;function j(t){var s=-1,l=t==null?0:t.length;for(this.clear();++s<l;){var _=t[s];this.set(_[0],_[1])}}function Cn(){this.__data__=[],this.size=0}function On(t){var s=this.__data__,l=be(s,t);if(l<0)return!1;var _=s.length-1;return l==_?s.pop():Ct.call(s,l,1),--this.size,!0}function En(t){var s=this.__data__,l=be(s,t);return l<0?void 0:s[l][1]}function xn(t){return be(this.__data__,t)>-1}function In(t,s){var l=this.__data__,_=be(l,t);return _<0?(++this.size,l.push([t,s])):l[_][1]=s,this}j.prototype.clear=Cn,j.prototype.delete=On,j.prototype.get=En,j.prototype.has=xn,j.prototype.set=In;function U(t){var s=-1,l=t==null?0:t.length;for(this.clear();++s<l;){var _=t[s];this.set(_[0],_[1])}}function Pn(){this.size=0,this.__data__={hash:new Y,map:new(ye||j),string:new Y}}function Ln(t){var s=Ve(this,t).delete(t);return this.size-=s?1:0,s}function Dn(t){return Ve(this,t).get(t)}function Bn(t){return Ve(this,t).has(t)}function Rn(t,s){var l=Ve(this,t),_=l.size;return l.set(t,s),this.size+=l.size==_?0:1,this}U.prototype.clear=Pn,U.prototype.delete=Ln,U.prototype.get=Dn,U.prototype.has=Bn,U.prototype.set=Rn;function ve(t){var s=-1,l=t==null?0:t.length;for(this.__data__=new U;++s<l;)this.add(t[s])}function jn(t){return this.__data__.set(t,d),this}function $n(t){return this.__data__.has(t)}ve.prototype.add=ve.prototype.push=jn,ve.prototype.has=$n;function $(t){var s=this.__data__=new j(t);this.size=s.size}function Kn(){this.__data__=new j,this.size=0}function Nn(t){var s=this.__data__,l=s.delete(t);return this.size=s.size,l}function Un(t){return this.__data__.get(t)}function Hn(t){return this.__data__.has(t)}function Fn(t,s){var l=this.__data__;if(l instanceof j){var _=l.__data__;if(!ye||_.length<a-1)return _.push([t,s]),this.size=++l.size,this;l=this.__data__=new U(_)}return l.set(t,s),this.size=l.size,this}$.prototype.clear=Kn,$.prototype.delete=Nn,$.prototype.get=Un,$.prototype.has=Hn,$.prototype.set=Fn;function Gn(t,s){var l=we(t),_=!l&&tr(t),C=!l&&!_&&le(t),A=!l&&!_&&!C&&jt(t),I=l||_||C||A,E=I?fn(t.length,String):[],D=E.length;for(var P in t)(s||V.call(t,P))&&!(I&&(P=="length"||C&&(P=="offset"||P=="parent")||A&&(P=="buffer"||P=="byteLength"||P=="byteOffset")||Zn(P,D)))&&E.push(P);return E}function be(t,s){for(var l=t.length;l--;)if(Bt(t[l][0],s))return l;return-1}function Wn(t,s,l){var _=s(t);return we(t)?_:At(_,l(t))}function Be(t){return t==null?t===void 0?gt:ht:pe&&pe in Object(t)?Jn(t):er(t)}function Et(t){return je(t)&&Be(t)==c}function xt(t,s,l,_,C){return t===s?!0:t==null||s==null||!je(t)&&!je(s)?t!==t&&s!==s:It(t,s,l,_,xt,C)}function It(t,s,l,_,C,A){var I=we(t),E=we(s),D=I?g:ue(t),P=E?g:ue(s);D=D==c?k:D,P=P==c?k:P;var G=D==k,J=P==k,B=D==P;if(B&&le(t)){if(!le(s))return!1;I=!0,G=!1}if(B&&!G)return A||(A=new $),I||jt(t)?Pt(t,s,l,_,C,A):Vn(t,s,D,l,_,C,A);if(!(l&u)){var H=G&&V.call(t,"__wrapped__"),W=J&&V.call(s,"__wrapped__");if(H||W){var he=H?t.value():t,fe=W?s.value():s;return A||(A=new $),C(he,fe,l,_,A)}}return B?(A||(A=new $),Yn(t,s,l,_,C,A)):!1}function qn(t){if(!Re(t)||Qn(t))return!1;var s=Rt(t)?Tt:sn;return s.test(ce(t))}function zn(t){return je(t)&&ut(t.length)&&!!O[Be(t)]}function ft(t){if(!kn(t))return ot(t);var s=[];for(var l in Object(t))V.call(t,l)&&l!="constructor"&&s.push(l);return s}function Pt(t,s,l,_,C,A){var I=l&u,E=t.length,D=s.length;if(E!=D&&!(I&&D>E))return!1;var P=A.get(t);if(P&&A.get(s))return P==s;var G=-1,J=!0,B=l&h?new ve:void 0;for(A.set(t,s),A.set(s,t);++G<E;){var H=t[G],W=s[G];if(_)var he=I?_(W,H,G,s,t,A):_(H,W,G,t,s,A);if(he!==void 0){if(he)continue;J=!1;break}if(B){if(!St(s,function(fe,Ae){if(!cn(B,Ae)&&(H===fe||C(H,fe,l,_,A)))return B.push(Ae)})){J=!1;break}}else if(!(H===W||C(H,W,l,_,A))){J=!1;break}}return A.delete(t),A.delete(s),J}function Vn(t,s,l,_,C,A,I){switch(l){case Ue:if(t.byteLength!=s.byteLength||t.byteOffset!=s.byteOffset)return!1;t=t.buffer,s=s.buffer;case yt:return!(t.byteLength!=s.byteLength||!A(new Mt(t),new Mt(s)));case w:case z:case Ee:return Bt(+t,+s);case R:return t.name==s.name&&t.message==s.message;case xe:case ke:return t==s+"";case ne:var E=dn;case Ie:var D=_&u;if(E||(E=rt),t.size!=s.size&&!D)return!1;var P=I.get(t);if(P)return P==s;_|=h,I.set(t,s);var G=Pt(E(t),E(s),_,C,A,I);return I.delete(t),G;case et:if(ze)return ze.call(t)==ze.call(s)}return!1}function Yn(t,s,l,_,C,A){var I=l&u,E=Lt(t),D=E.length,P=Lt(s),G=P.length;if(D!=G&&!I)return!1;for(var J=D;J--;){var B=E[J];if(!(I?B in s:V.call(s,B)))return!1}var H=A.get(t);if(H&&A.get(s))return H==s;var W=!0;A.set(t,s),A.set(s,t);for(var he=I;++J<D;){B=E[J];var fe=t[B],Ae=s[B];if(_)var Nt=I?_(Ae,fe,B,s,t,A):_(fe,Ae,B,t,s,A);if(!(Nt===void 0?fe===Ae||C(fe,Ae,l,_,A):Nt)){W=!1;break}he||(he=B=="constructor")}if(W&&!he){var Se=t.constructor,Ye=s.constructor;Se!=Ye&&"constructor"in t&&"constructor"in s&&!(typeof Se=="function"&&Se instanceof Se&&typeof Ye=="function"&&Ye instanceof Ye)&&(W=!1)}return A.delete(t),A.delete(s),W}function Lt(t){return Wn(t,rr,Xn)}function Ve(t,s){var l=t.__data__;return Dt(s)?l[typeof s=="string"?"string":"hash"]:l.map}function Ce(t,s){var l=ln(t,s);return qn(l)?l:void 0}function Jn(t){var s=V.call(t,pe),l=t[pe];try{t[pe]=void 0;var _=!0}catch{}var C=st.call(t);return _&&(s?t[pe]=l:delete t[pe]),C}var Xn=Ot?function(t){return t==null?[]:(t=Object(t),wt(Ot(t),function(s){return at.call(t,s)}))}:$t,ue=Be;(ge&&ue(new ge(new ArrayBuffer(1)))!=Ue||ye&&ue(new ye)!=ne||Pe&&ue(Pe.resolve())!=Qe||Le&&ue(new Le)!=Ie||_e&&ue(new _e)!=Me)&&(ue=function(t){var s=Be(t),l=s==k?t.constructor:void 0,_=l?ce(l):"";if(_)switch(_){case _n:return Ue;case vn:return ne;case bn:return Qe;case wn:return Ie;case We:return Me}return s});function Zn(t,s){return s=s==null?f:s,!!s&&(typeof t=="number"||an.test(t))&&t>-1&&t%1==0&&t<s}function Dt(t){var s=typeof t;return s=="string"||s=="number"||s=="symbol"||s=="boolean"?t!=="__proto__":t===null}function Qn(t){return!!Ge&&Ge in t}function kn(t){var s=t&&t.constructor,l=typeof s=="function"&&s.prototype||Fe;return t===l}function er(t){return st.call(t)}function ce(t){if(t!=null){try{return mt.call(t)}catch{}try{return t+""}catch{}}return""}function Bt(t,s){return t===s||t!==t&&s!==s}var tr=Et(function(){return arguments}())?Et:function(t){return je(t)&&V.call(t,"callee")&&!at.call(t,"callee")},we=Array.isArray;function nr(t){return t!=null&&ut(t.length)&&!Rt(t)}var le=yn||Kt;function de(t,s){return xt(t,s)}function Rt(t){if(!Re(t))return!1;var s=Be(t);return s==M||s==te||s==y||s==pt}function ut(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=f}function Re(t){var s=typeof t;return t!=null&&(s=="object"||s=="function")}function je(t){return t!=null&&typeof t=="object"}var jt=bt?un(bt):zn;function rr(t){return nr(t)?Gn(t):ft(t)}function $t(){return[]}function Kt(){return!1}i.exports=de})(se,se.exports);var Te=se.exports,Je={exports:{}},m={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xe=Symbol.for("react.element"),gr=Symbol.for("react.portal"),yr=Symbol.for("react.fragment"),_r=Symbol.for("react.strict_mode"),vr=Symbol.for("react.profiler"),br=Symbol.for("react.provider"),wr=Symbol.for("react.context"),Ar=Symbol.for("react.forward_ref"),Sr=Symbol.for("react.suspense"),mr=Symbol.for("react.memo"),Tr=Symbol.for("react.lazy"),ir=Symbol.iterator;function Mr(i){return i===null||typeof i!="object"?null:(i=ir&&i[ir]||i["@@iterator"],typeof i=="function"?i:null)}var sr={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ar=Object.assign,or={};function Ke(i,r,a){this.props=i,this.context=r,this.refs=or,this.updater=a||sr}Ke.prototype.isReactComponent={},Ke.prototype.setState=function(i,r){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,r,"setState")},Ke.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function fr(){}fr.prototype=Ke.prototype;function Ft(i,r,a){this.props=i,this.context=r,this.refs=or,this.updater=a||sr}var Gt=Ft.prototype=new fr;Gt.constructor=Ft,ar(Gt,Ke.prototype),Gt.isPureReactComponent=!0;var ur=Array.isArray,cr=Object.prototype.hasOwnProperty,Wt={current:null},lr={key:!0,ref:!0,__self:!0,__source:!0};function dr(i,r,a){var d,u={},h=null,f=null;if(r!=null)for(d in r.ref!==void 0&&(f=r.ref),r.key!==void 0&&(h=""+r.key),r)cr.call(r,d)&&!lr.hasOwnProperty(d)&&(u[d]=r[d]);var c=arguments.length-2;if(c===1)u.children=a;else if(1<c){for(var g=Array(c),y=0;y<c;y++)g[y]=arguments[y+2];u.children=g}if(i&&i.defaultProps)for(d in c=i.defaultProps,c)u[d]===void 0&&(u[d]=c[d]);return{$$typeof:Xe,type:i,key:h,ref:f,props:u,_owner:Wt.current}}function Cr(i,r){return{$$typeof:Xe,type:i.type,key:r,ref:i.ref,props:i.props,_owner:i._owner}}function qt(i){return typeof i=="object"&&i!==null&&i.$$typeof===Xe}function Or(i){var r={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(a){return r[a]})}var hr=/\/+/g;function zt(i,r){return typeof i=="object"&&i!==null&&i.key!=null?Or(""+i.key):r.toString(36)}function ct(i,r,a,d,u){var h=typeof i;(h==="undefined"||h==="boolean")&&(i=null);var f=!1;if(i===null)f=!0;else switch(h){case"string":case"number":f=!0;break;case"object":switch(i.$$typeof){case Xe:case gr:f=!0}}if(f)return f=i,u=u(f),i=d===""?"."+zt(f,0):d,ur(u)?(a="",i!=null&&(a=i.replace(hr,"$&/")+"/"),ct(u,r,a,"",function(y){return y})):u!=null&&(qt(u)&&(u=Cr(u,a+(!u.key||f&&f.key===u.key?"":(""+u.key).replace(hr,"$&/")+"/")+i)),r.push(u)),1;if(f=0,d=d===""?".":d+":",ur(i))for(var c=0;c<i.length;c++){h=i[c];var g=d+zt(h,c);f+=ct(h,r,a,g,u)}else if(g=Mr(i),typeof g=="function")for(i=g.call(i),c=0;!(h=i.next()).done;)h=h.value,g=d+zt(h,c++),f+=ct(h,r,a,g,u);else if(h==="object")throw r=String(i),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return f}function lt(i,r,a){if(i==null)return i;var d=[],u=0;return ct(i,d,"","",function(h){return r.call(a,h,u++)}),d}function Er(i){if(i._status===-1){var r=i._result;r=r(),r.then(function(a){(i._status===0||i._status===-1)&&(i._status=1,i._result=a)},function(a){(i._status===0||i._status===-1)&&(i._status=2,i._result=a)}),i._status===-1&&(i._status=0,i._result=r)}if(i._status===1)return i._result.default;throw i._result}var q={current:null},dt={transition:null},xr={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:dt,ReactCurrentOwner:Wt};m.Children={map:lt,forEach:function(i,r,a){lt(i,function(){r.apply(this,arguments)},a)},count:function(i){var r=0;return lt(i,function(){r++}),r},toArray:function(i){return lt(i,function(r){return r})||[]},only:function(i){if(!qt(i))throw Error("React.Children.only expected to receive a single React element child.");return i}},m.Component=Ke,m.Fragment=yr,m.Profiler=vr,m.PureComponent=Ft,m.StrictMode=_r,m.Suspense=Sr,m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xr,m.cloneElement=function(i,r,a){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var d=ar({},i.props),u=i.key,h=i.ref,f=i._owner;if(r!=null){if(r.ref!==void 0&&(h=r.ref,f=Wt.current),r.key!==void 0&&(u=""+r.key),i.type&&i.type.defaultProps)var c=i.type.defaultProps;for(g in r)cr.call(r,g)&&!lr.hasOwnProperty(g)&&(d[g]=r[g]===void 0&&c!==void 0?c[g]:r[g])}var g=arguments.length-2;if(g===1)d.children=a;else if(1<g){c=Array(g);for(var y=0;y<g;y++)c[y]=arguments[y+2];d.children=c}return{$$typeof:Xe,type:i.type,key:u,ref:h,props:d,_owner:f}},m.createContext=function(i){return i={$$typeof:wr,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:br,_context:i},i.Consumer=i},m.createElement=dr,m.createFactory=function(i){var r=dr.bind(null,i);return r.type=i,r},m.createRef=function(){return{current:null}},m.forwardRef=function(i){return{$$typeof:Ar,render:i}},m.isValidElement=qt,m.lazy=function(i){return{$$typeof:Tr,_payload:{_status:-1,_result:i},_init:Er}},m.memo=function(i,r){return{$$typeof:mr,type:i,compare:r===void 0?null:r}},m.startTransition=function(i){var r=dt.transition;dt.transition={};try{i()}finally{dt.transition=r}},m.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},m.useCallback=function(i,r){return q.current.useCallback(i,r)},m.useContext=function(i){return q.current.useContext(i)},m.useDebugValue=function(){},m.useDeferredValue=function(i){return q.current.useDeferredValue(i)},m.useEffect=function(i,r){return q.current.useEffect(i,r)},m.useId=function(){return q.current.useId()},m.useImperativeHandle=function(i,r,a){return q.current.useImperativeHandle(i,r,a)},m.useInsertionEffect=function(i,r){return q.current.useInsertionEffect(i,r)},m.useLayoutEffect=function(i,r){return q.current.useLayoutEffect(i,r)},m.useMemo=function(i,r){return q.current.useMemo(i,r)},m.useReducer=function(i,r,a){return q.current.useReducer(i,r,a)},m.useRef=function(i){return q.current.useRef(i)},m.useState=function(i){return q.current.useState(i)},m.useSyncExternalStore=function(i,r,a){return q.current.useSyncExternalStore(i,r,a)},m.useTransition=function(){return q.current.useTransition()},m.version="18.1.0",Je.exports=m;const Ir=(i,r)=>i===r,Pr=(()=>{const i=!!(typeof window!="undefined"&&window.document&&window.document.createElement),r=typeof navigator!="undefined"&&navigator.product==="ReactNative";return i||r})();let Lr=!1;const Dr=()=>Pr&&!Lr,Br=i=>i,Rr=(i,r=Br,a=Ir)=>{if(!(i._subscribers instanceof Set))throw new Error("Invalid entity.");const[d,u]=Je.exports.useState(r(i._value)),h=Je.exports.useCallback(c=>{const g=r(c);!a(d,g)&&u(g)},[r,a,d]);return(Dr()?Je.exports.useLayoutEffect:Je.exports.useEffect)(()=>i._subscribe(h),[h,i]),h(i._value),d};let jr=!1;const $r=()=>jr,Kr=new Set,Nr=(i,r=[])=>{if(i===void 0)throw new Error("Entity requires an initial value.");if(!(r instanceof Array))throw new Error("Invalid plug-ins array.");const a={_value:void 0,_subscribers:new Set};return a._subscribe=Gr(a),a.get=()=>a._value,a.set=Ur(a),a.init=Hr(a,i),a.use=Fr(a),Wr(a,r),a.init(),$r()&&Kr.add(a),a},Ur=i=>(r,...a)=>{typeof r=="function"&&(r=r(i._value,...a)),i._value=r,i._subscribers.forEach(d=>d(i._value))},Hr=(i,r)=>r&&typeof r.then=="function"?()=>{r.then(a=>setTimeout(()=>i.set(a)))}:()=>{i._value=r},Fr=i=>(...r)=>Rr(i,...r),Gr=i=>r=>(i._subscribers.add(r),()=>{i._subscribers.delete(r)}),Wr=(i,r)=>{r.forEach(a=>{if(typeof a!="object")throw new Error("Invalid plug-in");const d=u=>{if(typeof a[u]=="function"){const h=a[u](i[u],i);if(typeof h!="function")throw new Error(`Invalid override for '${u}' in plug-in.`);i[u]=h}};d("init"),d("set")})};var Ze=Nr,qr=zr;function Ne(i){return i instanceof Buffer?Buffer.from(i):new i.constructor(i.buffer.slice(),i.byteOffset,i.length)}function zr(i){if(i=i||{},i.circles)return Vr(i);return i.proto?d:a;function r(u,h){for(var f=Object.keys(u),c=new Array(f.length),g=0;g<f.length;g++){var y=f[g],w=u[y];typeof w!="object"||w===null?c[y]=w:w instanceof Date?c[y]=new Date(w):ArrayBuffer.isView(w)?c[y]=Ne(w):c[y]=h(w)}return c}function a(u){if(typeof u!="object"||u===null)return u;if(u instanceof Date)return new Date(u);if(Array.isArray(u))return r(u,a);if(u instanceof Map)return new Map(r(Array.from(u),a));if(u instanceof Set)return new Set(r(Array.from(u),a));var h={};for(var f in u)if(Object.hasOwnProperty.call(u,f)!==!1){var c=u[f];typeof c!="object"||c===null?h[f]=c:c instanceof Date?h[f]=new Date(c):c instanceof Map?h[f]=new Map(r(Array.from(c),a)):c instanceof Set?h[f]=new Set(r(Array.from(c),a)):ArrayBuffer.isView(c)?h[f]=Ne(c):h[f]=a(c)}return h}function d(u){if(typeof u!="object"||u===null)return u;if(u instanceof Date)return new Date(u);if(Array.isArray(u))return r(u,d);if(u instanceof Map)return new Map(r(Array.from(u),d));if(u instanceof Set)return new Set(r(Array.from(u),d));var h={};for(var f in u){var c=u[f];typeof c!="object"||c===null?h[f]=c:c instanceof Date?h[f]=new Date(c):c instanceof Map?h[f]=new Map(r(Array.from(c),d)):c instanceof Set?h[f]=new Set(r(Array.from(c),d)):ArrayBuffer.isView(c)?h[f]=Ne(c):h[f]=d(c)}return h}}function Vr(i){var r=[],a=[];return i.proto?h:u;function d(f,c){for(var g=Object.keys(f),y=new Array(g.length),w=0;w<g.length;w++){var z=g[w],R=f[z];if(typeof R!="object"||R===null)y[z]=R;else if(R instanceof Date)y[z]=new Date(R);else if(ArrayBuffer.isView(R))y[z]=Ne(R);else{var M=r.indexOf(R);M!==-1?y[z]=a[M]:y[z]=c(R)}}return y}function u(f){if(typeof f!="object"||f===null)return f;if(f instanceof Date)return new Date(f);if(Array.isArray(f))return d(f,u);if(f instanceof Map)return new Map(d(Array.from(f),u));if(f instanceof Set)return new Set(d(Array.from(f),u));var c={};r.push(f),a.push(c);for(var g in f)if(Object.hasOwnProperty.call(f,g)!==!1){var y=f[g];if(typeof y!="object"||y===null)c[g]=y;else if(y instanceof Date)c[g]=new Date(y);else if(y instanceof Map)c[g]=new Map(d(Array.from(y),u));else if(y instanceof Set)c[g]=new Set(d(Array.from(y),u));else if(ArrayBuffer.isView(y))c[g]=Ne(y);else{var w=r.indexOf(y);w!==-1?c[g]=a[w]:c[g]=u(y)}}return r.pop(),a.pop(),c}function h(f){if(typeof f!="object"||f===null)return f;if(f instanceof Date)return new Date(f);if(Array.isArray(f))return d(f,h);if(f instanceof Map)return new Map(d(Array.from(f),h));if(f instanceof Set)return new Set(d(Array.from(f),h));var c={};r.push(f),a.push(c);for(var g in f){var y=f[g];if(typeof y!="object"||y===null)c[g]=y;else if(y instanceof Date)c[g]=new Date(y);else if(y instanceof Map)c[g]=new Map(d(Array.from(y),h));else if(y instanceof Set)c[g]=new Set(d(Array.from(y),h));else if(ArrayBuffer.isView(y))c[g]=Ne(y);else{var w=r.indexOf(y);w!==-1?c[g]=a[w]:c[g]=h(y)}}return r.pop(),a.pop(),c}}var Vt={exports:{}};(function(i,r){var a=200,d="Expected a function",u="__lodash_hash_undefined__",h=1,f=2,c=1/0,g=9007199254740991,y="[object Arguments]",w="[object Array]",z="[object Boolean]",R="[object Date]",M="[object Error]",te="[object Function]",ne="[object GeneratorFunction]",Ee="[object Map]",ht="[object Number]",k="[object Object]",Qe="[object Promise]",pt="[object RegExp]",xe="[object Set]",Ie="[object String]",ke="[object Symbol]",et="[object WeakMap]",gt="[object ArrayBuffer]",Me="[object DataView]",yt="[object Float32Array]",Ue="[object Float64Array]",Yt="[object Int8Array]",Jt="[object Int16Array]",Xt="[object Int32Array]",Zt="[object Uint8Array]",Qt="[object Uint8ClampedArray]",kt="[object Uint16Array]",en="[object Uint32Array]",tn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nn=/^\w*$/,rn=/^\./,sn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,an=/[\\^$.*+?()[\]{}|]/g,O=/\\(\\)?/g,_t=/^\[object .+?Constructor\]$/,on=/^(?:0|[1-9]\d*)$/,T={};T[yt]=T[Ue]=T[Yt]=T[Jt]=T[Xt]=T[Zt]=T[Qt]=T[kt]=T[en]=!0,T[y]=T[w]=T[gt]=T[z]=T[Me]=T[R]=T[M]=T[te]=T[Ee]=T[ht]=T[k]=T[pt]=T[xe]=T[Ie]=T[et]=!1;var tt=typeof Z=="object"&&Z&&Z.Object===Object&&Z,vt=typeof self=="object"&&self&&self.Object===Object&&self,ae=tt||vt||Function("return this")(),He=r&&!r.nodeType&&r,nt=He&&!0&&i&&!i.nodeType&&i,bt=nt&&nt.exports===He,wt=bt&&tt.process,At=function(){try{return wt&&wt.binding("util")}catch{}}(),St=At&&At.isTypedArray;function fn(e,n,o,p){for(var b=-1,v=e?e.length:0;++b<v;){var S=e[b];n(p,S,o(S),e)}return p}function un(e,n){for(var o=-1,p=e?e.length:0;++o<p;)if(n(e[o],o,e))return!0;return!1}function cn(e){return function(n){return n==null?void 0:n[e]}}function ln(e,n){for(var o=-1,p=Array(e);++o<e;)p[o]=n(o);return p}function dn(e){return function(n){return e(n)}}function hn(e,n){return e==null?void 0:e[n]}function rt(e){var n=!1;if(e!=null&&typeof e.toString!="function")try{n=!!(e+"")}catch{}return n}function pn(e){var n=-1,o=Array(e.size);return e.forEach(function(p,b){o[++n]=[b,p]}),o}function gn(e,n){return function(o){return e(n(o))}}function Fe(e){var n=-1,o=Array(e.size);return e.forEach(function(p){o[++n]=p}),o}var it=Array.prototype,mt=Function.prototype,V=Object.prototype,Ge=ae["__core-js_shared__"],st=function(){var e=/[^.]+$/.exec(Ge&&Ge.keys&&Ge.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Tt=mt.toString,ee=V.hasOwnProperty,oe=V.toString,Mt=RegExp("^"+Tt.call(ee).replace(an,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),at=ae.Symbol,Ct=ae.Uint8Array,pe=V.propertyIsEnumerable,Ot=it.splice,yn=gn(Object.keys,Object),ot=le(ae,"DataView"),ge=le(ae,"Map"),ye=le(ae,"Promise"),Pe=le(ae,"Set"),Le=le(ae,"WeakMap"),_e=le(Object,"create"),De=l(ot),_n=l(ge),vn=l(ye),bn=l(Pe),wn=l(Le),We=at?at.prototype:void 0,qe=We?We.valueOf:void 0,ze=We?We.toString:void 0;function Y(e){var n=-1,o=e?e.length:0;for(this.clear();++n<o;){var p=e[n];this.set(p[0],p[1])}}function An(){this.__data__=_e?_e(null):{}}function Sn(e){return this.has(e)&&delete this.__data__[e]}function mn(e){var n=this.__data__;if(_e){var o=n[e];return o===u?void 0:o}return ee.call(n,e)?n[e]:void 0}function Tn(e){var n=this.__data__;return _e?n[e]!==void 0:ee.call(n,e)}function Mn(e,n){var o=this.__data__;return o[e]=_e&&n===void 0?u:n,this}Y.prototype.clear=An,Y.prototype.delete=Sn,Y.prototype.get=mn,Y.prototype.has=Tn,Y.prototype.set=Mn;function j(e){var n=-1,o=e?e.length:0;for(this.clear();++n<o;){var p=e[n];this.set(p[0],p[1])}}function Cn(){this.__data__=[]}function On(e){var n=this.__data__,o=be(n,e);if(o<0)return!1;var p=n.length-1;return o==p?n.pop():Ot.call(n,o,1),!0}function En(e){var n=this.__data__,o=be(n,e);return o<0?void 0:n[o][1]}function xn(e){return be(this.__data__,e)>-1}function In(e,n){var o=this.__data__,p=be(o,e);return p<0?o.push([e,n]):o[p][1]=n,this}j.prototype.clear=Cn,j.prototype.delete=On,j.prototype.get=En,j.prototype.has=xn,j.prototype.set=In;function U(e){var n=-1,o=e?e.length:0;for(this.clear();++n<o;){var p=e[n];this.set(p[0],p[1])}}function Pn(){this.__data__={hash:new Y,map:new(ge||j),string:new Y}}function Ln(e){return we(this,e).delete(e)}function Dn(e){return we(this,e).get(e)}function Bn(e){return we(this,e).has(e)}function Rn(e,n){return we(this,e).set(e,n),this}U.prototype.clear=Pn,U.prototype.delete=Ln,U.prototype.get=Dn,U.prototype.has=Bn,U.prototype.set=Rn;function ve(e){var n=-1,o=e?e.length:0;for(this.__data__=new U;++n<o;)this.add(e[n])}function jn(e){return this.__data__.set(e,u),this}function $n(e){return this.__data__.has(e)}ve.prototype.add=ve.prototype.push=jn,ve.prototype.has=$n;function $(e){this.__data__=new j(e)}function Kn(){this.__data__=new j}function Nn(e){return this.__data__.delete(e)}function Un(e){return this.__data__.get(e)}function Hn(e){return this.__data__.has(e)}function Fn(e,n){var o=this.__data__;if(o instanceof j){var p=o.__data__;if(!ge||p.length<a-1)return p.push([e,n]),this;o=this.__data__=new U(p)}return o.set(e,n),this}$.prototype.clear=Kn,$.prototype.delete=Nn,$.prototype.get=Un,$.prototype.has=Hn,$.prototype.set=Fn;function Gn(e,n){var o=E(e)||I(e)?ln(e.length,String):[],p=o.length,b=!!p;for(var v in e)(n||ee.call(e,v))&&!(b&&(v=="length"||ut(v,p)))&&o.push(v);return o}function be(e,n){for(var o=e.length;o--;)if(A(e[o][0],n))return o;return-1}function Wn(e,n,o,p){return Be(e,function(b,v,S){n(p,b,o(b),S)}),p}var Be=kn(xt),Et=er();function xt(e,n){return e&&Et(e,n,Se)}function It(e,n){n=Re(n,e)?[n]:Dt(n);for(var o=0,p=n.length;e!=null&&o<p;)e=e[s(n[o++])];return o&&o==p?e:void 0}function qn(e){return oe.call(e)}function zn(e,n){return e!=null&&n in Object(e)}function ft(e,n,o,p,b){return e===n?!0:e==null||n==null||!B(e)&&!H(n)?e!==e&&n!==n:Pt(e,n,ft,o,p,b)}function Pt(e,n,o,p,b,v){var S=E(e),x=E(n),L=w,K=w;S||(L=de(e),L=L==y?k:L),x||(K=de(n),K=K==y?k:K);var X=L==k&&!rt(e),Q=K==k&&!rt(n),N=L==K;if(N&&!X)return v||(v=new $),S||he(e)?ce(e,n,o,p,b,v):Bt(e,n,L,o,p,b,v);if(!(b&f)){var re=X&&ee.call(e,"__wrapped__"),ie=Q&&ee.call(n,"__wrapped__");if(re||ie){var Oe=re?e.value():e,me=ie?n.value():n;return v||(v=new $),o(Oe,me,p,b,v)}}return N?(v||(v=new $),tr(e,n,o,p,b,v)):!1}function Vn(e,n,o,p){var b=o.length,v=b,S=!p;if(e==null)return!v;for(e=Object(e);b--;){var x=o[b];if(S&&x[2]?x[1]!==e[x[0]]:!(x[0]in e))return!1}for(;++b<v;){x=o[b];var L=x[0],K=e[L],X=x[1];if(S&&x[2]){if(K===void 0&&!(L in e))return!1}else{var Q=new $;if(p)var N=p(K,X,L,e,n,Q);if(!(N===void 0?ft(X,K,p,h|f,Q):N))return!1}}return!0}function Yn(e){if(!B(e)||jt(e))return!1;var n=G(e)||rt(e)?Mt:_t;return n.test(l(e))}function Lt(e){return H(e)&&J(e.length)&&!!T[oe.call(e)]}function Ve(e){return typeof e=="function"?e:e==null?Ye:typeof e=="object"?E(e)?Xn(e[0],e[1]):Jn(e):Zr(e)}function Ce(e){if(!rr(e))return yn(e);var n=[];for(var o in Object(e))ee.call(e,o)&&o!="constructor"&&n.push(o);return n}function Jn(e){var n=nr(e);return n.length==1&&n[0][2]?Kt(n[0][0],n[0][1]):function(o){return o===e||Vn(o,e,n)}}function Xn(e,n){return Re(e)&&$t(n)?Kt(s(e),n):function(o){var p=Ae(o,e);return p===void 0&&p===n?Nt(o,e):ft(n,p,void 0,h|f)}}function ue(e){return function(n){return It(n,e)}}function Zn(e){if(typeof e=="string")return e;if(W(e))return ze?ze.call(e):"";var n=e+"";return n=="0"&&1/e==-c?"-0":n}function Dt(e){return E(e)?e:t(e)}function Qn(e,n){return function(o,p){var b=E(o)?fn:Wn,v=n?n():{};return b(o,e,Ve(p),v)}}function kn(e,n){return function(o,p){if(o==null)return o;if(!D(o))return e(o,p);for(var b=o.length,v=n?b:-1,S=Object(o);(n?v--:++v<b)&&p(S[v],v,S)!==!1;);return o}}function er(e){return function(n,o,p){for(var b=-1,v=Object(n),S=p(n),x=S.length;x--;){var L=S[e?x:++b];if(o(v[L],L,v)===!1)break}return n}}function ce(e,n,o,p,b,v){var S=b&f,x=e.length,L=n.length;if(x!=L&&!(S&&L>x))return!1;var K=v.get(e);if(K&&v.get(n))return K==n;var X=-1,Q=!0,N=b&h?new ve:void 0;for(v.set(e,n),v.set(n,e);++X<x;){var re=e[X],ie=n[X];if(p)var Oe=S?p(ie,re,X,n,e,v):p(re,ie,X,e,n,v);if(Oe!==void 0){if(Oe)continue;Q=!1;break}if(N){if(!un(n,function(me,$e){if(!N.has($e)&&(re===me||o(re,me,p,b,v)))return N.add($e)})){Q=!1;break}}else if(!(re===ie||o(re,ie,p,b,v))){Q=!1;break}}return v.delete(e),v.delete(n),Q}function Bt(e,n,o,p,b,v,S){switch(o){case Me:if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case gt:return!(e.byteLength!=n.byteLength||!p(new Ct(e),new Ct(n)));case z:case R:case ht:return A(+e,+n);case M:return e.name==n.name&&e.message==n.message;case pt:case Ie:return e==n+"";case Ee:var x=pn;case xe:var L=v&f;if(x||(x=Fe),e.size!=n.size&&!L)return!1;var K=S.get(e);if(K)return K==n;v|=h,S.set(e,n);var X=ce(x(e),x(n),p,b,v,S);return S.delete(e),X;case ke:if(qe)return qe.call(e)==qe.call(n)}return!1}function tr(e,n,o,p,b,v){var S=b&f,x=Se(e),L=x.length,K=Se(n),X=K.length;if(L!=X&&!S)return!1;for(var Q=L;Q--;){var N=x[Q];if(!(S?N in n:ee.call(n,N)))return!1}var re=v.get(e);if(re&&v.get(n))return re==n;var ie=!0;v.set(e,n),v.set(n,e);for(var Oe=S;++Q<L;){N=x[Q];var me=e[N],$e=n[N];if(p)var pr=S?p($e,me,N,n,e,v):p(me,$e,N,e,n,v);if(!(pr===void 0?me===$e||o(me,$e,p,b,v):pr)){ie=!1;break}Oe||(Oe=N=="constructor")}if(ie&&!Oe){var Ut=e.constructor,Ht=n.constructor;Ut!=Ht&&"constructor"in e&&"constructor"in n&&!(typeof Ut=="function"&&Ut instanceof Ut&&typeof Ht=="function"&&Ht instanceof Ht)&&(ie=!1)}return v.delete(e),v.delete(n),ie}function we(e,n){var o=e.__data__;return je(n)?o[typeof n=="string"?"string":"hash"]:o.map}function nr(e){for(var n=Se(e),o=n.length;o--;){var p=n[o],b=e[p];n[o]=[p,b,$t(b)]}return n}function le(e,n){var o=hn(e,n);return Yn(o)?o:void 0}var de=qn;(ot&&de(new ot(new ArrayBuffer(1)))!=Me||ge&&de(new ge)!=Ee||ye&&de(ye.resolve())!=Qe||Pe&&de(new Pe)!=xe||Le&&de(new Le)!=et)&&(de=function(e){var n=oe.call(e),o=n==k?e.constructor:void 0,p=o?l(o):void 0;if(p)switch(p){case De:return Me;case _n:return Ee;case vn:return Qe;case bn:return xe;case wn:return et}return n});function Rt(e,n,o){n=Re(n,e)?[n]:Dt(n);for(var p,b=-1,S=n.length;++b<S;){var v=s(n[b]);if(!(p=e!=null&&o(e,v)))break;e=e[v]}if(p)return p;var S=e?e.length:0;return!!S&&J(S)&&ut(v,S)&&(E(e)||I(e))}function ut(e,n){return n=n==null?g:n,!!n&&(typeof e=="number"||on.test(e))&&e>-1&&e%1==0&&e<n}function Re(e,n){if(E(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||W(e)?!0:nn.test(e)||!tn.test(e)||n!=null&&e in Object(n)}function je(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}function jt(e){return!!st&&st in e}function rr(e){var n=e&&e.constructor,o=typeof n=="function"&&n.prototype||V;return e===o}function $t(e){return e===e&&!B(e)}function Kt(e,n){return function(o){return o==null?!1:o[e]===n&&(n!==void 0||e in Object(o))}}var t=C(function(e){e=fe(e);var n=[];return rn.test(e)&&n.push(""),e.replace(sn,function(o,p,b,v){n.push(b?v.replace(O,"$1"):p||o)}),n});function s(e){if(typeof e=="string"||W(e))return e;var n=e+"";return n=="0"&&1/e==-c?"-0":n}function l(e){if(e!=null){try{return Tt.call(e)}catch{}try{return e+""}catch{}}return""}var _=Qn(function(e,n,o){ee.call(e,o)?++e[o]:e[o]=1});function C(e,n){if(typeof e!="function"||n&&typeof n!="function")throw new TypeError(d);var o=function(){var p=arguments,b=n?n.apply(this,p):p[0],v=o.cache;if(v.has(b))return v.get(b);var S=e.apply(this,p);return o.cache=v.set(b,S),S};return o.cache=new(C.Cache||U),o}C.Cache=U;function A(e,n){return e===n||e!==e&&n!==n}function I(e){return P(e)&&ee.call(e,"callee")&&(!pe.call(e,"callee")||oe.call(e)==y)}var E=Array.isArray;function D(e){return e!=null&&J(e.length)&&!G(e)}function P(e){return H(e)&&D(e)}function G(e){var n=B(e)?oe.call(e):"";return n==te||n==ne}function J(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=g}function B(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function H(e){return!!e&&typeof e=="object"}function W(e){return typeof e=="symbol"||H(e)&&oe.call(e)==ke}var he=St?dn(St):Lt;function fe(e){return e==null?"":Zn(e)}function Ae(e,n,o){var p=e==null?void 0:It(e,n);return p===void 0?o:p}function Nt(e,n){return e!=null&&Rt(e,n,zn)}function Se(e){return D(e)?Gn(e):Ce(e)}function Ye(e){return e}function Zr(e){return Re(e)?cn(s(e)):ue(e)}i.exports=_})(Vt,Vt.exports);var Yr=Vt.exports;class Jr{constructor(){F(this,"numMoves");F(this,"numMovesNoCapture");F(this,"currentTurn");F(this,"numWhiteLeft");F(this,"numBlackLeft");F(this,"whiteKingAlive");F(this,"blackKingAlive");F(this,"winner");F(this,"winMessage");F(this,"selectedPiece");F(this,"layout");F(this,"validMoves");F(this,"boardStateTracker");F(this,"boardWidth");F(this,"boardHeight");this.numMoves=0,this.numMovesNoCapture=0,this.currentTurn=Ze(1),this.whiteKingAlive=!0,this.blackKingAlive=!0,this.winner=Ze(0),this.winMessage="",this.selectedPiece=Ze([-1,-1]),this.layout=Ze([[2,2,2,2,2,2,2,2],[0,0,0,0,4,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,3,0,0,0,0],[1,1,1,1,1,1,1,1]]);const r=Yr(this.layout.get().flat());this.numWhiteLeft=r[1],this.numBlackLeft=r[2],this.boardWidth=this.layout.get()[0].length,this.boardHeight=this.layout.get().length,this.validMoves=Ze([""]),this.boardStateTracker=new Map}copyState(){return JSON.stringify({currentTurn:this.currentTurn.get(),numWhiteLeft:this.numWhiteLeft,numBlackLeft:this.numBlackLeft,whiteKingAlive:this.whiteKingAlive,blackKingAlive:this.blackKingAlive,winner:this.winner.get(),selectedPiece:this.selectedPiece.get(),layout:this.layout.get(),boardStateTracker:JSON.stringify(Array.from(this.boardStateTracker.entries()))})}loadState(r){const{currentTurn:a,numWhiteLeft:d,numBlackLeft:u,whiteKingAlive:h,blackKingAlive:f,winner:c,selectedPiece:g,layout:y,boardStateTracker:w}=JSON.parse(r);this.currentTurn.set(a),this.numWhiteLeft=d,this.numBlackLeft=u,this.whiteKingAlive=h,this.blackKingAlive=f,this.winner.set(c),this.selectedPiece.set(g),this.layout.set(y),this.boardStateTracker=new Map(JSON.parse(w))}setSelectedPiece([r,a]){this.selectedPiece.set([r,a])}toggleTurn(){this.currentTurn.set(r=>r===1?2:1)}getBoardValue(r,a){if(r<0||r>this.layout.get().length-1||a<0||a>this.layout.get()[0].length-1)return[-1,!1];const d=this.layout.get()[r][a]>2;return[d?this.layout.get()[r][a]-2:this.layout.get()[r][a],d]}makeMove({start:r,end:a}){var R;const[d,u]=r,[h,f]=a,c=this.layout.get(),g=c[d][u];c[h][f]=g,c[d][u]=0,this.layout.set(c);const y=c.flat().join("");this.boardStateTracker.set(y,((R=this.boardStateTracker.get(y))!=null?R:0)+1),this.resetValidMoves(),this.processCaptures(h,f);const w=this.currentTurn.get()===1?2:1;this.numMoves+=1,this.numMovesNoCapture+=1,!this.checkForWinCondition(w)&&this.toggleTurn()}checkForWinCondition(r){if(r===2){if(!this.blackKingAlive)return this.winMessage="You've captured your opponent's king!",this.winner.set(1),!0;if(this.numBlackLeft===0)return this.winMessage="You've captured all of your opponent's pawns!",this.winner.set(1),!0}if(r===1){if(!this.whiteKingAlive)return this.winMessage="Your king has been captured!",this.winner.set(2),!0;if(this.numWhiteLeft===0)return this.winMessage="Your opponent captured all of your pawns!",this.winner.set(2),!0}if(this.getAllValidMoves(r).length===0)return this.winMessage=r==2?"Black has no valid moves from this point, meaning you win!":"White has no valid moves from this point, meaning your opponent wins!",this.winner.set(this.currentTurn.get()),!0;if(this.numMovesNoCapture==50)return this.numBlackLeft>=this.numWhiteLeft?(this.winner.set(2),this.winMessage="50 moves and no capture. Your opponent wins this round with more (or equal) pieces!",!0):(this.winner.set(1),this.winMessage="50 moves and no capture. You win this round with more pieces!",!0)}simulateMove({start:r,end:a}){const[d,u]=r,[h,f]=a,c=qr()(this.layout.get()),g=c[d][u];return c[h][f]=g,c[d][u]=0,c}doCapture(r,a,d=!1){const[u]=this.getBoardValue(r,a);if(this.layout.set(h=>(h[r][a]=0,h)),this.numMovesNoCapture=0,d)switch(u){case 1:{this.whiteKingAlive=!1;return}case 2:{this.blackKingAlive=!1;return}}u===1?this.numWhiteLeft-=1:this.numBlackLeft-=1}addValidMove(r,a){const d=[r,a].join("|");this.validMoves.set(u=>[...u,d])}getBlockers(r,a){r=r.map(h=>h===0?0:1);const d=r.slice(0,a).lastIndexOf(1),u=a+1+r.slice(a+1).indexOf(1);return[d,u===a?8:u]}getAllValidMoves(r=0){const a=[];for(let d=0;d<this.layout.get().length;d++)for(let u=0;u<this.layout.get()[d].length;u++){if(r!==0&&this.getBoardValue(d,u)[0]!==r)continue;const[h,f]=this.getValidMoves(d,u);a.push(...h.map(c=>({start:[d,u],end:[c,u]}))),a.push(...f.map(c=>({start:[d,u],end:[d,c]})))}return a}getValidMoves(r,a){const d=this.layout.get()[r][a];if(d===0)return[[],[]];const u=d>2,h=this.layout.get().map(M=>M[a]),f=this.layout.get()[r],[c,g]=this.getBlockers(h,r),[y,w]=this.getBlockers(f,a),z=h.map((M,te)=>te).filter(M=>u?M>=r-1&&M<=r+1:!0).filter(M=>M>c&&M<g&&M!==r).filter(M=>{var ne;const te=this.simulateMove({start:[r,a],end:[M,a]}).flat().join("");return((ne=this.boardStateTracker.get(te))!=null?ne:0)<3}),R=f.map((M,te)=>te).filter(M=>u?M>=a-1&&M<=a+1:!0).filter(M=>M>y&&M<w&&M!==a).filter(M=>{var ne;const te=this.simulateMove({start:[r,a],end:[r,M]}).flat().join("");return((ne=this.boardStateTracker.get(te))!=null?ne:0)<3});return[z,R]}resetValidMoves(){this.validMoves.set([""])}isValidMove(r,a){return this.validMoves.get().includes([r,a].join("|"))}processCaptures(r,a){const d=[[r-1,a],[r+1,a],[r,a-1],[r,a+1]],u=this.currentTurn.get()===1?2:1;for(const[h,f]of d){const[c,g]=this.getBoardValue(h,f);c===u&&(g&&this.getValidMoves(h,f)[0].length===0&&this.getValidMoves(h,f)[1].length===0?this.doCapture(h,f,!0):!g&&(this.isSurroundedOnOppositeSides(h,f)||this.isCornered(h,f))&&this.doCapture(h,f))}}isSurroundedOnOppositeSides(r,a){const d=this.currentTurn.get(),[u,h,f,c]=this.getAdjacentSquares(r,a);return[u,h].every(g=>g===d)||[f,c].every(g=>g===d)}isSurroundedOnAllSides(r,a){return this.getAdjacentSquares(r,a).every(d=>d===1||d===2)}getAdjacentSquares(r,a){const[d]=this.getBoardValue(r-1,a),[u]=this.getBoardValue(r+1,a),[h]=this.getBoardValue(r,a-1),[f]=this.getBoardValue(r,a+1);return[d,u,h,f]}isCornered(r,a){const[d,u,h,f]=this.getAdjacentSquares(r,a),c=this.currentTurn.get();switch(!0){case(r===0&&a===0):return u===c&&f===c;case(r===0&&a===this.boardWidth-1):return u===c&&h===c;case(r===this.boardHeight-1&&a===0):return d===c&&f===c;case(r===this.boardHeight-1&&a===this.boardWidth-1):return d===c&&h===c}}}class Xr{constructor(){F(this,"board");this.board=new Jr}run(r,a=3){return this.board.loadState(r),this.getMove([],a,r,-1/0,1/0)}getMove(r,a,d,u,h){this.board.loadState(d);for(const c of r)this.board.makeMove(c);if(a===0||this.isEndState())return{score:this.heuristic(),bestMove:r[0]};const f={score:0,bestMove:{start:[0,0],end:[0,0]}};if(this.board.currentTurn.get()===1){f.score=1/0;const c=this.board.getAllValidMoves(1);for(const g of c){const y=[...r,g],w=this.getMove(y,a-1,d,u,h);if(Te(f.bestMove,{start:[0,0],end:[0,0]})&&(f.score=w.score,f.bestMove=w.bestMove),w.score<f.score&&(f.score=w.score,f.bestMove=w.bestMove),w.score===f.score&&Math.random()<.1&&(f.score=w.score,f.bestMove=w.bestMove),f.score>=h)break;u=Math.max(u,f.score)}}else{f.score=-1/0;const c=this.board.getAllValidMoves(2);for(const g of c){const y=[...r,g],w=this.getMove(y,a-1,d,u,h);if(Te(f.bestMove,{start:[0,0],end:[0,0]})&&(f.score=w.score,f.bestMove=w.bestMove),w.score>f.score&&(f.score=w.score,f.bestMove=w.bestMove),w.score===f.score&&Math.random()<.1&&(f.score=w.score,f.bestMove=w.bestMove),f.score<=u)break;h=Math.min(h,f.score)}}return this.board.loadState(d),f}heuristic(){return this.board.numWhiteLeft===0?1/0:this.board.numBlackLeft===0?-1/0:this.board.whiteKingAlive===!1?1/0:this.board.blackKingAlive===!1?-1/0:10*this.board.numBlackLeft-this.board.numWhiteLeft}isEndState(){return this.board.numWhiteLeft===0||this.board.numBlackLeft===0||this.board.whiteKingAlive===!1||this.board.blackKingAlive===!1}}self.onmessage=i=>{const[r,a]=i.data,d=new Xr,{bestMove:u}=d.run(r,a);self.postMessage(u)}})();
